<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Big Ambitions · 满流量最低家具计算器</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
      margin: 32px;
    }

    .card {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 20px;
      max-width: 860px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
    }

    h1 {
      margin-top: 0;
      font-size: 22px;
    }

    label {
      display: block;
      margin: 12px 0 6px;
      font-weight: 600;
    }

    select,
    button {
      padding: 10px 12px;
      font-size: 14px;
    }

    button {
      cursor: pointer;
    }

    .row {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .col {
      flex: 1 1 200px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 14px;
    }

    th,
    td {
      border: 1px solid #eee;
      padding: 8px 10px;
      text-align: left;
    }

    th {
      background: #fafafa;
    }

    .muted {
      color: #666;
      font-size: 13px;
    }

    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #f2f2f2;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>Big Ambitions · 满流量最低家具计算器</h1>
    <form method="post">
      <div class="row">
        <div class="col">
          <label for="business">业务类型</label>
          <select id="business" name="business">
            {% for key in business_keys %}
            <option value="{{key}}" {% if business==key %}selected{% endif %}>{{business_labels[key]}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col">
          <label for="building">建筑代码</label>
          <select id="building" name="building">
            {% for b in building_keys %}
            <option value="{{b}}" {% if building==b %}selected{% endif %}>{{b}}（{{building_caps[b]}}/小时）</option>
            {% endfor %}
          </select>
        </div>
      </div>
  </div>

  <div style="margin-top:16px">
    <button type="submit">计算</button>
  </div>
  </form>

  {% if result %}
  <hr style="margin:20px 0">
  <p class="muted">建筑满流量目标：<span class="pill">{{result.target}} 客/小时</span></p>

  <table>
    <thead>
      <tr>
        <th>功能组</th>
        <th>组合明细（名称 × 件数 × 单件容量）</th>
        <th>合计件数</th>
        <th>该组总容量</th>
      </tr>
    </thead>
    <tbody>
      {% for row in result.plan %}
      <tr>
        <td>{{ {"basket":"购物篮","checkout":"结账/收银","shelf":"书架"}[row.group] }}</td>
        <td>
          {% for it in row.combo %}
          <div>{{ it.furniture_name }} × {{ it.count }}（{{ it.each_capacity }}/小时）</div>
          {% endfor %}
        </td>
        <td>{{ row.total_count }}</td>
        <td>{{ row.total_capacity }}/小时</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="margin-top:10px">最低人手建议：<strong>{{result.employees_min}} 人</strong>（每个结账点 1 人 + 1 名机动）</p>
  {% endif %}


  <p class="muted" style="margin-top:16px">
    当前内置业务：书店。若要扩展到服装店/咖啡店，只需在 <code>BUSINESS_SPECS</code> 中补充各家具容量与组别。
  </p>
  </div>
</body>

</html>